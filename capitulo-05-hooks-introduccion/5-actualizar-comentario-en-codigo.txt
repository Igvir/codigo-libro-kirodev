// TODO(P1): Refactorizar esta funci√≥n - muy compleja
// Tracked: PROJ-1234
