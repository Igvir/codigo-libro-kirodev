# Auto-generar Tests Unitarios

## Trigger: On File Save
## Pattern: src/**/*.ts

Cuando se guarda un archivo TypeScript en src/:

**Analizar:**
1. Identificar todas las funciones y métodos exportados (públicos)
2. Detectar nuevas funciones o funciones modificadas desde el último save

**Generar tests solo si:**
- La función es pública (exportada)
- No es un archivo .test.ts, .spec.ts, o .config.ts
- El archivo no está en node_modules o __tests__

**Para cada función pública:**

1. **Test de caso exitoso principal:**
- Ejecutar la función con inputs válidos típicos
- Validar que el output cumple con el tipo esperado
- Verificar comportamiento correcto

2. **Tests de validación:**
- Inputs vacíos, null, undefined
- Inputs fuera de rango
- Tipos incorrectos
- Validar que los errores se lanzan apropiadamente

3. **Tests de edge cases:**
- Valores límite (0, -1, MAX_INT, etc.)
- Arrays vacíos vs. con elementos
- Strings vacíos vs. muy largos

**Estructura del test:**
- Framework: Vitest
- Ubicación: __tests__/[ruta-relativa]/[nombre-archivo].test.ts
- Estilo: describe/it blocks
- Nombres descriptivos: "debe [comportamiento esperado]"
- Mock external dependencies cuando sea necesario

**Importante:**
- NO sobrescribir tests existentes escritos manualmente
- Si ya existe el archivo de test, solo AGREGAR tests para funciones nuevas
- Marcar tests generados con comentario: `// Auto-generated by Kiro`
- Importar correctamente desde el archivo fuente

**Ejemplo de output esperado:**
```typescript
// __tests__/auth/token-service.test.ts
// Auto-generated by Kiro
import { describe, it, expect } from 'vitest';
import { TokenService } from '../../src/auth/token-service';

describe('TokenService', () => {
describe('generateToken', () => {
it('debe generar un token válido para userId proporcionado', async () => {
const service = new TokenService();
const token = await service.generateToken('user-123');
expect(token).toBeDefined();
expect(typeof token).toBe('string');
});

it('debe rechazar userId vacío', async () => {
const service = new TokenService();
await expect(
service.generateToken('')
).rejects.toThrow();
});
});
});
